/*!CK:3039669539!*//*1409628810,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["qH5+b"]); }

__d("XAdPreferencesInterestsWriteControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/ads\/preferences\/edit_interests\/",{ad_id:{type:"Int",required:true},action:{type:"Enum",required:true},type:{type:"Enum",required:true},fbids:{type:"IntVector",required:true}});},null);
__d("XAdPreferencesNUXControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/ads\/preferences\/nux\/",{type:{type:"String",required:true}});},null);
__d("XAdsPreferencesFeedbackControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/ads\/preferences\/feeedback\/",{ad_id:{type:"Int",required:true},favorite:{type:"Enum",required:true}});},null);
__d("AdsPrefs",["AsyncRequest","CSS","DOM","Event","tidyEvent","cx","csx","XAdPreferencesInterestsWriteControllerURIBuilder","XAdPreferencesNUXControllerURIBuilder","XAdsPreferencesFeedbackControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(u,v){var w=i.scry(u.parentNode,"div._g1j")[0],x=h.hasClass(w,"_2zny")?'add':'del',y=new n().setInt('ad_id',v).setEnum('action',x).setEnum('type',w.getAttribute('data-type')).setIntVector('fbids',[w.getAttribute('data-fbid')]).getURI();new g(y).send();h.toggleClass(w,"_2zny");return w;}function r(u,v){h.toggleClass(u,"hidden_elem");var w=h.hasClass(u,"hidden_elem")?'ad_useful':'ad_neutral',x=new p().setInt('ad_id',v).setEnum('favorite',w).getURI(),y=new g(x);y.send();}function s(){var u=new o().setString('type','interest_nux_ts').getURI();new g(u).send();}var t={initRHCFeedback:function(u,v,w){k(j.listen(v,'click',function(x){r(w,u);x.kill();}));},initSuggestions:function(u,v,w){k(j.listen(v,'click',function(x){q(x.target,u);}));if(w)k(j.listen(w,'click',function(){i.scry(v,'li').forEach(function(x){h.show(x);});h.hide(w);}));},initMatchingInterests:function(u,v,w){var x=i.scry(v,"div._g1j")[0];if(x){h.removeClass(x,"_2hg");}else return;k(j.listen(v,'click',function(y){q(x,u);var z=i.scry(v,"span._58yk")[0];if(h.hasClass(x,"_2zny")){h.removeClass(z,'hidden_elem');if(w){w.subscribe('hide',s);w.setContext(x);w.show();w=null;}}else h.addClass(z,'hidden_elem');}));},initExpandable:function(u){k(j.listen(u,'click',function(v){var w=i.scry(u,"div._2fdq")[0],x=i.scry(u,"._4r43")[0],y=i.scry(u,"._1uhj")[0];h.toggleClass(x,'hidden_elem');h.toggleClass(y,'hidden_elem');h.toggleClass(w,'hidden_elem');}));},toggleFavorite:function(u){var v=i.find(u.getRoot(),'img');r(v,u.getLabel());}};e.exports=t;},null);
__d("EntstreamStoryDeduper",["AsyncRequest","Arbiter","DOM","csx","CSS","CacheStorage"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(p,q){var r={};for(var s=0;s<p.length;s++){var t=p[s],u=t.getAttribute('data-dedupekey');if(r[u]){if(q){k.hide(t);h.inform('FbFeedUnreadPillNavigation/logDedupe',{story:t,action:'dedupe_story_hide'});}else{i.remove(t);h.inform('FbFeedUnreadPillNavigation/logDedupe',{story:t,action:'dedupe_story_remove'});}}else r[u]=1;}}function n(p,q){var r={},s=0,t=Date.now()/1000/3600,u=30;for(var v=0;v<u;++v){var w=new l('localstorage','vpv_local_log.'+parseInt(t-v,10)+'h'),x=w.keys();s+=x.length>0;for(var y=0;y<x.length;y++)r[x[y]]=1;}var z=0,aa=0,ba;for(var ca=0;ca<p.length;ca++){var da=p[ca],ea=da.getAttribute('data-dedupekey'),fa='checkedVPVLocalCache';if(k.hasClass(da,fa)){continue;}else k.addClass(da,fa);++z;if(r[ea]&&k.shown(da)){ba=ea;++aa;if(q){k.hide(da);}else i.remove(da);}}if(z>0)new g('/ajax/feed/feed_tracking/vpv_local_storage_log').setData({num_vpvs:Object.keys(r).length,num_hours:s,num_seen_stories:aa,num_unseen_stories:z,seen_story_key:ba}).send();}var o={dedupe:function(p,q){q=q||"._5jmm";var r=i.scry(p,q);r=r.filter(function(s){return s.getAttribute('data-dedupekey');});m(r,false);},dedupeHide:function(p,q,r){q=q||"._5jmm";var s=i.scry(p,q),t=s.filter(function(x){return x.getAttribute('data-dedupekey')&&k.shown(x);});m(t,true);if(r){var u=i.scry(p,".unread_session");for(var v=0;v<u.length;++v){var w=i.scry(u[v],q);w.length&&n(w,true);}}}};e.exports=o;},null);
__d("EntstreamFeedObject",["Parent","cx"],function(a,b,c,d,e,f,g,h){var i={getRoot:function(j){return g.byClass(j,"_5jmm");}};e.exports=i;},null);
__d("EntstreamFeedObjectFollowup",["CSS","DOM","EntstreamFeedObject","Event","csx","cx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n={getFollowup:function(o){var p=h.scry(o,"._5lum");if(!p.length)p=h.scry(o.parentNode,"._5lum");return p?p[0]:null;},initCloseButton:function(o){var p=h.find(o,"._5xsl"),q=j.listen(p,'click',function(){q.remove();h.remove(o);});o.listener=q;},stopListenCloseButton:function(o){if(o.listener)o.listener.remove();},addFollowup:function(o,p,q){var r=g.hasClass(o,"_5pat"),s=h.create('div',{className:"_5lum"});if(r){g.addClass(s,"_5pau");}else g.addClass(s,"_1f84");if(q)g.addClass(s,q);if(p){h.appendContent(s,p);this.initCloseButton(s);h.insertBefore(o,s);}else{var t=n.getFollowup(o);if(t)this.removeFollowup(t);h.prependContent(o,s);}return s;},removeFollowup:function(o){var p=n.getFollowup(o);this.stopListenCloseButton(p);h.remove(p);},appendToFollowup:function(o,p){var q=i.getRoot(m(o)),r=n.getFollowup(q);h.appendContent(r,p);},getFollowupMessage:function(o){var p=h.find(o,"._1f86");return p;},replaceFollowupMessage:function(o,p){this.stopListenCloseButton(o);var q=n.getFollowupMessage(o);h.replace(q,p);this.initCloseButton(o);}};e.exports=n;},null);
__d("EntstreamFeedObjectFollow",["EntstreamFeedObject","EntstreamFeedObjectFollowup","Event","Parent","cx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={toggleFollow:function(n,o,p){var q=n.getValue()=='follow_post'?p.follow_post:p.unfollow_post,r=g.getRoot(l(o)),s=h.getFollowup(r);if(s){h.replaceFollowupMessage(s,q);}else{s=h.addFollowup(r,q,"_521o")||h.getFollowup(r);i.listen(s,'click',function(event){var t=event.getTarget(),u="_1f89";if(j.byClass(t,u)){m.toggleFollow(n,o,p);n.toggleMenuItem();}});}}};e.exports=m;},null);
__d("EntstreamFeedObjectHide",["Event","CSS","EntstreamFeedObject","EntstreamFeedObjectFollowup","Focus","TabbableElements","cx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o={hide:function(p,q){var r=i.getRoot(n(p));j.addFollowup(r,q);h.addClass(r,"_i6m");o.setFocus(r);},registerUnhide:function(p,q){g.listen(p,'click',function(){if(q)q.send();o.unhide(i.getRoot(p));});},setFocus:function(p){var q=l.find(p);if(q&&q[0])k.setWithoutOutline(q[0]);},unhide:function(p){j.removeFollowup(p);h.removeClass(p,"_i6m");o.setFocus(p);}};e.exports=o;},null);
__d("YouTube",["CSS","DOM","DOMQuery","Event","Keys","LitestandStoryInsertionStatus","SubscriptionsHandler","UserAgent_DEPRECATED","Focus","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(s,t,u){"use strict";var v=new m();v.addSubscriptions(j.listen(s,'load',this.listening.bind(this)),l.registerBlocker(function(){return this.playerState===r.STATE_PLAYING;}.bind(this)));p(this,{iframe:s,autofocus:t,autoplay:u,playerState:r.STATE_UNSTARTED,muted:false,volume:100,currentTime:0,timer:null,handler:v});if(t)o.set(s);}r.prototype.id=function(){"use strict";return this.iframe.id;};r.prototype.post=function(s){"use strict";s.id=this.id();this.iframe.contentWindow.postMessage(JSON.stringify(s),'*');};r.prototype.listening=function(){"use strict";this.post({event:'listening'});clearTimeout(this.timer);this.timer=setTimeout(this.listening.bind(this),100);};r.prototype.update=function(s){"use strict";if(s.event=='initialDelivery'){clearTimeout(this.timer);if((n.webkit()||n.firefox())&&s.info&&s.info.debugText.match(/flashVersion/)){this.addAccessibleButtons();if(n.firefox())this.iframe.tabIndex=-1;}}if(s.info)['playerState','muted','volume','currentTime'].forEach(function(t){if(s.info.hasOwnProperty(t))this[t]=s.info[t];}.bind(this));};r.prototype.togglePlay=function(){"use strict";this.post({event:'command',func:(this.playerState==r.STATE_PLAYING)?'pauseVideo':'playVideo'});};r.prototype.toggleMute=function(){"use strict";this.post({event:'command',func:this.muted?'unMute':'mute'});};r.prototype.addAccessibleButtons=function(){"use strict";this.addAccessibleButton('Mute',"_505m",this.toggleMute.bind(this));this.addAccessibleButton('Play',"_505n",this.togglePlay.bind(this));};r.prototype.addAccessibleButton=function(s,t,u){"use strict";var v=h.create('button',{'class':t,tabindex:0},s);h.insertAfter(this.iframe,v);this.handler.addSubscriptions(j.listen(v,'click',u),j.listen(v,'mouseover',g.hide.bind(null,v)),j.listen(this.iframe,'mouseout',g.show.bind(null,v)),j.listen(v,'focus',function(){if(!this.autoplay&&this.playerState==r.STATE_UNSTARTED){this.post({event:'command',func:'playVideo'});this.post({event:'command',func:'pauseVideo'});}}.bind(this)),j.listen(v,'keydown',function(w){switch(w.keyCode){case k.UP:case k.DOWN:this.post({event:'command',func:'setVolume',args:[this.volume+((w.keyCode==k.UP)?10:-10)]});w.prevent();break;case k.RIGHT:case k.LEFT:this.post({event:'command',func:'seekTo',args:[this.currentTime+((w.keyCode==k.RIGHT)?10:-10)]});w.prevent();break;}}.bind(this)));return v;};r.prototype.destroy=function(){"use strict";this.handler.release();delete r.instances[this.id()];if(!Object.keys(r.instances).length)r.handler.remove();};r.register=function(s,t,u){"use strict";if(!window.postMessage)return;if(!Object.keys(r.instances).length)r.handler=j.listen(window,'message',function(w){try{var x=JSON.parse(w.data);if(r.instances[x.id])r.instances[x.id].update(x);}catch(w){}});var v=new r(i.find(s,'iframe'),t,u);r.instances[v.id()]=v;};p(r,{STATE_UNSTARTED:-1,STATE_PLAYING:1,instances:{},handler:null});e.exports=r;},null);
__d("EntstreamHomeFeedObjectHide",["AsyncRequest","CSS","DOM","EntstreamFeedObject","EntstreamFeedObjectHide","Event","TrackingNodes","YouTube","csx","cx","ge","tx","$"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t={stopVideo:function(u){var v=s(u),w=i.find(v,"^._5jmm"),x=i.scry(w,'iframe');for(var y=0;y<x.length;y++){var z=n.instances[i.getID(x[y])];if(z&&(z.playerState===n.STATE_PLAYING))z.togglePlay();}var aa=i.scry(w,'video');for(var ba=0;ba<aa.length;ba++)if(('paused' in aa[ba])&&!aa[ba].paused)if(typeof aa[ba].pause==='function')aa[ba].pause();},hide:function(u,v,w,x){t.stopVideo(u);var y=j.getRoot(q(u)),z=h.hasClass(y,"_5pat"),aa;if(z&&w=='afrostart'){aa='';}else{var ba=w=='hide'||w=='afrostart'?"This story is now hidden from your News Feed.":"This story has been marked as spam.",ca=w=='hide'||w=='afrostart'?"Unhide":"Undo",da=m.getTrackingInfo(m.types.UNHIDE_LINK),ea=i.create('a',{href:'#','data-ft':da},ca),fa={};if(v)fa.token=v;if(x)fa.hideable_token=x;var ga=new g().setURI('/ajax/entstream/home/story/unhide').setMethod('POST').setData(fa).setRelativeTo(ea);k.registerUnhide(ea,ga);aa=i.create('div',{'class':"_1f86"},[ba,' ',ea]);}k.hide(u,aa);},registerHide:function(u,v,w,x){l.listen(u,'click',function(){t.hide(u.getAttribute('id'),v,w,x);});}};e.exports=t;},null);
__d("MenuTogglingItem",["DOM","MenuItem"],function(a,b,c,d,e,f,g,h){for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(){"use strict";if(h!==null)h.apply(this,arguments);}k.prototype.handleClick=function(){"use strict";this.toggleMenuItem();return j.handleClick.call(this);};k.prototype.toggleMenuItem=function(){"use strict";this._swap('ajaxify','toggleAjaxify');this._swap('value','toggleValue');this._toggleItemText();};k.prototype.setValue=function(l){"use strict";this._data.value=l;};k.prototype._toggleItemText=function(){"use strict";var l=this._anchor;this._swap('markup','toggleMarkup');g.replace(l,this._renderItemContent());};k.prototype._swap=function(l,m){"use strict";var n=this._data[l];this._data[l]=this._data[m];this._data[m]=n;};e.exports=k;},null);
__d("EntstreamHomeFeedObjectOptionsMenu",["AdsPrefs","CSS","DOM","EntstreamHomeFeedObjectHide","EntstreamFeedObject","EntstreamFeedObjectFollow","MenuTogglingItem","UFICentralUpdates","UFIConstants","cx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(s,t,u,v,w,x){s.subscribe('itemclick',function(y,z){switch(z.item.getValue()){case 'hide':case 'markspam':case 'afrostart':j.hide(t,u,z.item.getValue(),w);break;case 'afro_direct_action':var aa=z.item.getRoot().getAttribute('data-optimistic-hide');if(aa){var ba=i.create('div',{className:"_5lum"});i.appendContent(ba,z.item.getRoot().getAttribute('data-action-in-progress-string'));i.insertBefore(k.getRoot(q(t)).firstChild,ba);h.addClass(k.getRoot(q(t)),"_i6m");}break;case 'follow_post':case 'unfollow_post':l.toggleFollow(z.item,t,v);break;case 'ad_useful':case 'ad_neutral':g.toggleFavorite(z.item);break;}}.bind(this));s.subscribe('show',function(){s.forEachItem(function(y){y.onShow();});});n.subscribe('update-actions',function(y,z){if(z.payloadsource===o.UFIPayloadSourceType.USER_ACTION){var aa=z.actions||[];for(var ba=0;ba<aa.length;ba++)if(aa[ba].actiontype===o.UFIActionType.ADD_COMMENT_ACTION){if(aa[ba].feedbackfbid!=x)return;s.getRoot();s.forEachItem(function(ca){if(ca instanceof m&&ca.getValue()==='unfollow_post')ca.handleClick();});}}});}e.exports=r;},null);
__d("PageAdsAttachmentLinkShareConstants",[],function(a,b,c,d,e,f){var g={LINK_ATTACHMENT_CLICK:'link_attachment_click'};e.exports=g;},null);
__d("LitestandViewportHeight",["Arbiter","CSS","Event","cx","debounce","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n={SMALL:'small',NORMAL:'normal',LARGE:'large',getSize:function(){if(m==="_4vcw")return n.SMALL;if(m==="_4vcx")return n.LARGE;return n.NORMAL;},init:function(o){n.init=l;var p=k(function(){var q=document.documentElement,r=q.clientHeight,s;if(r<=o.max_small_height){s="_4vcw";}else if(r>=o.min_large_height)s="_4vcx";if(s!==m){m&&h.removeClass(q,m);m=s;m&&h.addClass(q,m);g.inform('ViewportSizeChange');}});p();i.listen(window,'resize',p);}};e.exports=n;},null);
__d("runAfterScrollingStops",["Arbiter","Event","Run","debounceAcrossTransitions","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){function l(w,x,y){if(x&&o[x])return;if(!n){g.subscribe('page_transition',v);n=true;}if(!m){w();return;}x&&(o[x]=1);p.push(w);if(!y){if(r){i.onLeave(v);r=false;}q.push(p.length-1);}}var m,n,o={},p=[],q=[],r=true,s=500,t=j(function(){m=false;var w=p;p=[];q=[];o={};for(var x=0,y=w.length;x<y;++x)w[x]();},s);function u(){m=true;t();}function v(){var w=q;q=[];r=true;for(var x=0,y=w.length;x<y;++x)p[w[x]]=k;}h.listen(window,'scroll',u);e.exports=l;},null);
__d("LitestandOffscreenController",["Arbiter","CSS","DOM","Event","LitestandViewportHeight","NavigationMessage","Parent","Run","Style","SubscriptionsHandler","Vector","cx","csx","queryThenMutateDOM","runAfterScrollingStops","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w=1,x=9,y=7,z=10,aa={},ba=false,ca,da,ea,fa,ga=[];function ha(){ca&&ca.release();ca=null;ba=false;}function ia(){aa={};ga=[];}function ja(){for(var va in aa){var wa=aa[va];if(wa.hidden)wa.dirty=true;}}function ka(){if(h.hasClass(document.body,"body._5vb_")){return z;}else if(k.getSize()===k.SMALL)return y;return x;}function la(){fa=fa||q.getViewportDimensions().y;da=q.getScrollPosition().y;ea=da+fa;if(w){da-=fa*w;ea+=fa*w;}for(var va in aa){var wa=aa[va];wa.position=q.getElementPosition(wa.element).y;if(!wa.hidden)wa.height=wa.element.offsetHeight;}}function ma(){var va=[];for(var wa in aa){var xa=aa[wa],ya=xa.position,za=ya+xa.height<da,ab=ya>ea;if(!xa.hidden&&(za||ab)){na(xa);}else if(!za&&!ab){xa.pendingHide=false;if(xa.hidden){if(xa.dirty&&ya<da){va.push(wa);h.addClass(oa(xa),"_49nu");}else o.apply(xa.element,{height:'',marginBottom:''});h.show(oa(xa));xa.dirty=false;xa.hidden=false;}}}if(!va.length)return;var bb=0;t(function(){for(var cb=0,db=va.length;cb<db;cb++){var eb=aa[va[cb]];bb+=eb.height-oa(eb).offsetHeight+o.getFloat(eb.element,'marginBottom');}},function(){for(var cb=0,db=va.length;cb<db;cb++){var eb=aa[va[cb]];h.removeClass(oa(eb),"_49nu");o.apply(eb.element,{height:'',marginBottom:''});}bb&&(document.body.scrollTop-=bb);});}function na(va){if(!va.pendingHide){ga.push(va);va.pendingHide=true;}}function oa(va){if(va.wrapperElement)return va.wrapperElement;var wa=va.element;if(wa.firstElementChild)return (va.wrapperElement=wa.firstElementChild);for(var xa=0;xa<wa.childNodes.length;xa++)if(wa.childNodes[xa].tagName)return (va.wrapperElement=wa.childNodes[xa]);}function pa(){var va=ka()+'px';for(var wa=0;wa<ga.length;wa++){var xa=ga[wa];if(i.scry(xa.element,"._52fb").length)xa.pendingHide=false;if(xa&&xa.element&&xa.pendingHide&&!xa.hidden){o.apply(xa.element,{height:xa.height+'px',marginBottom:va});h.hide(oa(xa));xa.hidden=true;xa.pendingHide=false;}}ga=[];}function qa(){u(pa,'LitestandOffscreenController/hide');t(la,ma,'LitestandOffscreenController');}function ra(va,wa){var xa=m.byClass(wa.story,"_4ikz");if(!xa)return;xa=aa[i.getID(xa)];if(xa&&xa.hidden)xa.dirty=true;}function sa(va,wa){var xa=false;wa.forEach(function(ya){var za=aa[ya];if(za&&za.hidden){za.dirty=true;xa=true;if(za.position>=da){za.hidden=false;za.pendingHide=false;o.apply(za.element,{height:'',marginBottom:''});h.show(oa(za));}}});xa&&ma();}function ta(){n.onLeave(ha);ca=new p();ca.addSubscriptions(g.subscribe(l.NAVIGATION_BEGIN,ia),g.subscribe('Entstream/StoryUpdated',ra),g.subscribe('ViewportSizeChange',ja),g.subscribe('LitestandStream/SubstreamsUpdated',sa),j.listen(window,'scroll',v(qa)),j.listen(window,'resize',v(function(){fa=null;qa();})));ba=true;}var ua={attachSubstream:function(va){ba||ta();aa[i.getID(va)]={element:va};}};e.exports=ua;},null);
__d("LitestandNewStoryController",["Animation","Arbiter","AsyncRequest","EntstreamStoryDeduper","LitestandMessages","LitestandStream","Style","$","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=500,q=600,r,s;function t(){s&&clearTimeout(s);s=null;}function u(){s=setTimeout(function(){s=null;v();},p);}function v(){var y;o(function(){y=l.canInsertNewerStories();},function(){if(y){w();}else u();},'LitestandNewStoryController/tryShowingStories');}function w(){t();if(!r)return;j.dedupe(l.getStreamRoot(),l.getStoriesSelector());m.apply(r,{height:'',left:'',overflow:'',position:'',width:''});new g(r).from('opacity',0).to('opacity',1).duration(q).go();h.inform(k.STORIES_INSERTED);h.inform(k.NEWER_STORIES_INSERTED);setTimeout(function(){h.inform('reflow');},0);new i().setURI('/ajax/litestand/update_filter_viewtime').setData({section_id:l.getSectionID()}).send();r=null;}var x={waitForDisplay:function(y){if(!r)r=n(y);if(l.canInsertNewerStories()){w();}else u();},showStoriesFromPill:function(y){r=y;w();}};e.exports=x;},null);
__d("TrackingData",[],function(a,b,c,d,e,f){var g='mei',h='ei',i='cmf',j={hasAdToken:function(k){var l=k.getAttribute('data-ft')?JSON.parse(k.getAttribute('data-ft')):null;return l&&(l[g]||l[h]);},setContinueMainFeed:function(k){var l=k.getAttribute('data-ft')?JSON.parse(k.getAttribute('data-ft')):null;if(l){l[i]=1;k.setAttribute('data-ft',JSON.stringify(l));}}};e.exports=j;},null);
__d("LitestandStreamLoader",["Arbiter","AsyncRequest","CSS","csx","cx","DOM","DOMScroll","Event","FbFeedHighlight","JSXDOM","LitestandMessages","LitestandNewStoryController","LitestandOffscreenController","LitestandStream","NavigationMessage","OnVisible","Run","throttle","UIPagelet","UserActivity","EntstreamStoryDeduper","$","copyProperties","ge","getUnboundedScrollPosition","Vector","Parent","TrackingData"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){var ia=false,ja=false,ka={},la,ma,na,oa,pa,qa,ra=0,sa=false,ta,ua=null,va,wa=[],xa=false,ya=false,za,ab,bb=false,cb=true,db,eb=false,fb=false,gb=1000,hb=null,ib=false,jb=50,kb=0,lb,mb;function nb(){w.onLeave(pb);wa=[g.subscribe(q.PILL_VISIBILITY_UPDATED,function(ic,jc){sa=jc.pill_visibility;}),g.subscribe(q.NEW_STORIES_PILL_CLICKED,function(){r.showStoriesFromPill(mb);}),g.subscribe(u.NAVIGATION_BEGIN,pb),g.subscribe(q.NEWER_STORIES_INSERTED,function(){mb=null;}),g.subscribe(q.TOUR_BEGIN,function(){ia=true;}),g.subscribe(q.TOUR_END,function(){ia=false;tb();}),g.subscribe(q.UPDATE_STREAM,zb),g.subscribe(q.REFRESH_STREAM,zb),g.subscribe(q.UNREAD_ONLY_BEGIN,function(ic,jc){ib=true;var kc=ob(),lc=l.scry(za,".unseenStoriesHeader")[0],mc=[];if(lc&&kc){xa=true;var nc=l.scry(qa,t.getStoriesSelector()).slice(jc+1),oc=nc.length,pc=nc.filter(function(zc){return i.hasClass(zc,"_50mx")&&!i.hasClass(zc,"_x72")&&!ha.hasAdToken(zc);}),qc=pc.length,rc=db.min_stories_to_skip;if(nc.length-pc.length<rc)pc=pc.slice(0,nc.length-pc.length-rc);var sc=pc.length,tc=-1,uc={};if(db.move_skipped_unseen){var vc=p.div({className:"moved_stories"});pc.forEach(function(zc){var ad=ga.byClass(zc,"_4ikz");uc[l.getID(ad)]=1;l.appendContent(vc,zc);});g.inform('LitestandStream/SubstreamsUpdated',Object.keys(uc));l.insertAfter(lc,vc);tc=l.scry(za,".moved_stories ._5jmm").length;}mc=l.scry(za,t.getStoriesSelector());l.insertBefore(kc,za);i.show(za);mc.forEach(function(zc){i.show(zc);o.highlight(zc);});aa.dedupeHide(t.getStreamRoot(),t.getStoriesSelector(),bb);g.inform(q.STORIES_INSERTED);setTimeout(function(){m.scrollTo(lc,800,false,false,10);},0);qb();var wc=mc[0],xc=JSON.parse(wc.getAttribute('data-ft')),yc=xc.qid;rb('load',{all_unseen_stories:mc.length,qid:yc,main_feed_stories_skip:oc,unseen_stories_skipped:qc,unseen_stories_eligible_to_move:sc,unseen_stories_moved:tc});}else{if(!lc)rb('missed_stories_header_unavailable');if(!mc[0])rb('missed_stories_unseen_stories_unavailable');if(!kc)rb('missed_stories_more_pager_unavailable');}})];ja=true;}function ob(){if(ma.parentNode)return ma.parentNode;if(!qa)return;var ic=qa.children.length-1;while(ic>=0){if(qa.children[ic].id.lastIndexOf('more_pager',0)===0)return qa.children[ic];ic--;}return;}function pb(){g.inform(q.LEAVE_HOME);ka={};va=null;ra=0;wa.forEach(g.unsubscribe);wa=[];la&&la.remove();pa&&clearTimeout(pa);pa=null;oa=null;mb=null;ta&&ta.remove();ta=null;ja=false;kb=0;ua&&ua.remove();ua=null;xa=false;ya=false;fb=false;za=null;ab=null;bb=false;cb=true;db=null;eb=false;ib=false;hb=null;}function qb(){ka={};}function rb(ic,jc){var kc=-1,lc=-1,mc=-1,nc=l.scry(qa,".unread_session"),oc=0,pc=0,qc=null;for(var rc=0;rc<nc.length;++rc){var sc=l.scry(nc[rc],t.getStoriesSelector());for(var tc=0;tc<sc.length;++tc){var uc=sc[tc];if(!uc.getAttribute('data-dedupekey'))continue;++pc;if(i.shown(uc)){++oc;qc=uc;}}}lc=oc-1;if(qc){var vc=JSON.parse(qc.getAttribute('data-ft'));kc=vc.qid;mc=vc.mf_story_key;}var wc={qid:kc,finish_pos:lc,storyid:mc,feed_stream_id:t.getFeedStreamID(),all_unseen_stories:pc,num_unseen_sessions:nc.length};jc=typeof jc!=='undefined'?jc:{};for(var xc in wc)if(typeof jc[xc]==='undefined')jc[xc]=wc[xc];jc.action=ic;new h('/ajax/feed/pill/').setData(jc).send();}function sb(){if(pa)return;pa=setTimeout(function(){pa=null;ac();},va.pollIntervalMS);}function tb(){if(va&&oa&&va.pollIntervalMS&&va.pollIntervalMS>1000)sb();}function ub(){la=new v(l.find(ma,'a'),fc.bind(null),false,va.bufferPixels);}function vb(){var ic=ea(window).y;return ic>va.firstPagerScrollBuffer;}function wb(){if(vb()){ub();ta&&ta.remove();ta=null;}}function xb(){if(ib||!hb)return;var ic=l.scry(qa,t.getStoriesSelector()),jc=ba('leftCol'),kc=fa.getElementPosition(jc).y+fa.getElementDimensions(jc).y,lc=0;for(;lc<ic.length;lc++)if(!i.hasClass(ic[lc],"_2l4l")&&ic[lc].getAttribute('data-ft'))break;while(lc<ic.length&&fa.getElementPosition(ic[lc]).y<kc+jb)lc++;if(ic.length===lc)return;var mc=ic[lc],nc=hb.getElement();l.insertBefore(mc,nc);i.show(nc);hb.reflow();ib=true;}function yb(ic){xb();var jc=l.find(ma,'a');n.listen(jc,'click',function(event){fc();ta&&ta.remove();ta=null;event.preventDefault();});var kc=t.getVisibleStoryCount(qa),lc=va.maxStories;if(lc&&kc>=lc)return;if(ic&&!vb()){ta=n.listen(window,'scroll',x(wb));}else ub();}function zb(){ac();g.inform(q.UPDATE_LAST_REFRESH_TIME);}function ac(){if(ia||!oa)return;if(!z.isActive(va.newStoryIdleTime)){z.subscribeOnce(ac);return;}if(!t.canInsertNewerStories()){sb();return;}if(!mb){var ic=t.getStreamRoot();mb=p.div({style:{height:0,width:ic.offsetWidth+'px',left:'-10000px',opacity:0,overflow:'hidden',position:'absolute'}});l.prependContent(ic,mb);}if(!ua)ua=n.listen(window,'scroll',function(){if(t.canInsertNewerStories()!=sa)g.inform(q.TOGGLE_PILL_VISIBILITY);});var jc=p.div(null);l.prependContent(mb,jc);var kc=va.crossPage?{crossPage:true}:null;y.loadFromEndpoint('LitestandNewerStoriesPagelet',jc,ca(oa,{cursor:lb,containerID:l.getID(mb)}),kc);g.inform(q.PILL_CLEAR_COUNTER);}function bc(){var ic=l.getID(ma);i.addClass(ma,'async_saving');var jc=dc();if(ka[jc])throw new Error('This cursor has been used before, stories will be '+'repeated. Cursor: '+jc);ka[jc]=jc;var kc={cursor:jc,preload_next_cursor:ab,pager_config:na,pager_id:ic,scroll_count:++ra,start_unread_session:xa,start_continue_top_news_feed:ya,feed_stream_id:t.getFeedStreamID(),snapshot_time:db?db.snapshot_time:null};xa=false;ya=false;y.loadFromEndpoint(va.pagerController,l.getID(qa),kc,{append:true,automatic:true,usePipe:true,crossPage:va.crossPage});}function cc(){return ec()[0].getAttribute('data-cursor');}function dc(){var ic=ec();ic=ic.filter(function(jc){return !jc.getAttribute('data-preload_unseen_story');});return ic[ic.length-1].getAttribute('data-cursor');}function ec(){var ic=l.scry(qa,t.getStoriesSelector());return ic.filter(function(jc){return jc.getAttribute('data-cursor');});}function fc(){g.inform('FbFeedUnreadPillNavigation/startLoading');bc();la&&la.remove();la=null;}function gc(){if(!za||!ja)return [];var ic=l.scry(qa,t.getStoriesSelector()),jc=ic.filter(function(mc){return mc.getAttribute('data-dedupekey')&&!i.hasClass(mc,"preloadUnseenStory");}),kc={};for(var lc=0;lc<jc.length;lc++)kc[jc[lc].getAttribute('data-dedupekey')]=1;return l.scry(za,t.getStoriesSelector()).filter(function(mc){var nc=mc.getAttribute('data-dedupekey'),oc=nc&&!kc[nc];kc[nc]=1;return oc;});}var hc={register:function(ic,jc,kc,lc,mc){ja||nb();va=t.getStreamConfig(jc);xa=false;ya=false;fb=false;za=null;ab=null;bb=false;cb=true;db=null;eb=false;na=kc;qa=ba(ic);lb=cc();hb=mc;ib=false;ma=lc;yb(true);tb();},replacePagerConfig:function(ic){na=ic;},continueTopNewsFeed:function(){ya=true;fb=true;qb();rb('finish');},removeOldPager:function(ic,jc){if(ic)l.remove(ba(ic));i.show(ba(jc));},removeLoadingIndicator:function(ic,jc){var kc=da(ic);if(kc)l.remove(kc);i.show(jc);},moreStoriesInserted:function(ic){g.inform(q.STORIES_INSERTED,{substream_id:ic});var jc=ba(ic);if(fb)l.scry(jc,t.getStoriesSelector()).forEach(ha.setContinueMainFeed);if(t.hideOffscreenSubstreams())s.attachSubstream(jc);},attachNewPager:function(ic){!eb&&aa.dedupeHide(t.getStreamRoot(),t.getStoriesSelector(),bb);this.loadMoreUnseenStoriesIfNeeded();ma=ic;ma&&yb(false);},attachMissyElliot:function(ic){!eb&&aa.dedupeHide(t.getStreamRoot(),t.getStoriesSelector(),bb);rb('missy_elliot_show');if(ic){ma=ic;var jc=l.find(ic,"._1ner");n.listen(jc,'click',function(event){rb('missy_elliot_click');hc.forceNewFetch();var kc=fa.getScrollPosition();m.scrollTo(new fa(kc.x,0,'document'),750,false,false,0,function(){var lc=l.scry(qa,".unread_session");for(var mc=0;mc<lc.length;++mc)l.remove(lc[mc]);});fc();ta&&ta.remove();ta=null;event.preventDefault();});n.listen(jc,'mouseenter',x(function(){rb('missy_elliot_hover_star');},gb));n.listen(ic,'mouseenter',x(function(){rb('missy_elliot_hover_all');},gb));}},setPollerData:function(ic){if(ic){oa=ic;tb();}},updatePollerCursor:function(ic){lb=ic;tb();},headLoadCompleted:function(ic){lb=ic.newCursor;tb();var jc=ic.stories;if(jc&&jc.length>0){for(var kc=jc.length-1;kc>=0;kc--)jc[kc].setAttribute('data-insertion-position',--kb);g.inform('Stream/totalHeadLoadedStories',-kb);}},registerPreloadUnseenStories:function(ic,jc,kc,lc){za=ic;ab=jc;bb=kc;db=lc;if(lc)eb=lc.disable_deduper;hc.loadMoreUnseenStoriesIfNeeded();},morePreloadUnseenStories:function(ic,jc,kc){ab=kc;if(ic>0){l.appendContent(za,jc);this.loadMoreUnseenStoriesIfNeeded();}else{g.inform('FbFeedUnreadPillLoader/removeLoadingPill');g.inform('FbFeedUnreadPillNavigation/removePill');cb=true;rb('not_enough_remove',{all_unseen_stories:ic});}},setStopRecursiveUnseenLoad:function(ic){cb=ic;},loadMoreUnseenStoriesIfNeeded:function(){if(!db||cb)return;var ic=gc();if(ic.length<db.min_num){if(!za||db.disable_recursive){g.inform('FbFeedUnreadPillNavigation/removePill');cb=true;return;}y.loadFromEndpoint('LitestandUnseenStreamPagelet',za,{unread_pill_config:db,next_cursor:ab,mode:1},{append:true,automatic:true,usePipe:true,crossPage:va.crossPage});}else{g.inform('FbFeedUnreadPillNavigation/enoughLoaded');if(db.disable_recursive)cb=true;}},forceNewFetch:ac};e.exports=hc;},null);
__d("ViewportTrackingHelper",["Event","DOMDimensions","Vector"],function(a,b,c,d,e,f,g,h,i){var j={getScrollListener:function(k){return g.listen(window,'scroll',k);},looseIsVisible:function(k,l){if(!k.x&&!k.y&&!k.width&&!k.height)return false;var m=i.getScrollPosition().y,n=h.getViewportDimensions().height,o=n+l-m;return k.y<o;},isVisible:function(k,l){if(!k.x&&!k.y&&!k.width&&!k.height)return false;var m=h.getViewportDimensions().height,n=Math.max(k.y,0),o=Math.min(k.y+k.height,m),p=Math.min(k.height,l);return (o-n)>=p;}};e.exports=j;},null);
__d("ViewportDurationEmitter",["ViewportTrackingHelper","throttle","UserActivity","getElementPosition","SubscriptionsHandler","mixInEventEmitter"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(n,o){"use strict";this.getAllStoriesInfo=o;this.storyEnteredVPTimestamp={};this.alreadyEmittedStories=[];if(n){this.timetrackingThrottlingInterval=n.timetracking_throttling_interval;this.userActivityPollingInterval=n.user_activity_polling_interval;this.timeToBeConsideredInactive=n.time_to_be_considered_inactive;this.minFractionToBeVisibleForTimetracking=n.min_fraction_to_be_visible;this.minTimeToReportImmediately=n.min_time_to_report_immediately;this.minFractionForAdditionalView=n.min_fraction_for_additional_view;this.localStorageLogMinDurationMs=n.local_storage_log_min_duration_ms;}else{this.minFractionToBeVisibleForTimetracking=.5;this.minFractionForAdditionalView=0;this.timetrackingThrottlingInterval=100;this.minTimeToReportImmediately=500;}var p=h(this.updateTimeTrackingData.bind(this),this.timetrackingThrottlingInterval);this.subscriptions=new k();this.subscriptions.addSubscriptions(g.getScrollListener(p));this.userInactiveLock=false;this.userActivityPollerIntervalID=setInterval(this.$ViewportDurationEmitter0.bind(this),this.userActivityPollingInterval);this.updateTimeTrackingData();}m.prototype.cleanup=function(){"use strict";if(this.subscriptions){this.subscriptions.release();this.subscriptions=null;}clearInterval(this.userActivityPollerIntervalID);this.updateTimeTrackingData(true);};m.prototype.$ViewportDurationEmitter0=function(){"use strict";if(!this.userInactiveLock&&!i.isActive(this.timeToBeConsideredInactive)){this.userInactiveLock=true;this.updateTimeTrackingData(true);i.subscribeOnce(function(){this.updateTimeTrackingData();this.userInactiveLock=false;}.bind(this));}};m.prototype.getStoriesInfoInView=function(){"use strict";var n=this.getAllStoriesInfo(),o=[],p=false,q=0,r=n.length,s=1;if(this.$ViewportDurationEmitter1>r/2){q=r-1;r=-1;s=-s;}for(var t=q;t!=r;t+=s){var u=n[t].story,v=j(u);if(g.isVisible(v,this.minFractionToBeVisibleForTimetracking*v.height)){o.push(n[t]);p=true;}else if(p){this.$ViewportDurationEmitter1=t-s;break;}}for(t=this.alreadyEmittedStories.length-1;t>=0;t--){u=this.alreadyEmittedStories[t];v=j(u);if(!g.isVisible(v,this.minFractionForAdditionalView*v.height))this.alreadyEmittedStories.splice(t,1);}return o;};m.prototype.addVisibleStoriesTimestamps=function(n,o){"use strict";var p={};for(var q=0,r=n.length;q<r;q++){var s=n[q].story_id;p[s]=true;if(s in this.storyEnteredVPTimestamp)continue;this.storyEnteredVPTimestamp[s]={ts:o,story:n[q].story};}return p;};m.prototype.removeTimestampsOfStoriesNotInView=function(n,o){"use strict";for(var p in this.storyEnteredVPTimestamp)if(!(p in n)){var q=this.storyEnteredVPTimestamp[p].story,r=this.storyEnteredVPTimestamp[p].ts,s=o;if(this.alreadyEmittedStories.indexOf(q)==-1){this.emit('story_was_in_view',q,r,s);this.alreadyEmittedStories.push(q);}delete this.storyEnteredVPTimestamp[p];}};m.prototype.updateTimeTrackingData=function(n){"use strict";if(!this.storyEnteredVPTimestamp)this.storyEnteredVPTimestamp={};var o=Date.now(),p={},q;if(n===true){p={};}else p=this.getStoriesInfoInView();q=this.addVisibleStoriesTimestamps(p,o);this.removeTimestampsOfStoriesNotInView(q,o);};l(m,{story_was_in_view:true});e.exports=m;},null);
__d("ViewportStoryReadabilityEmitter",["mixInEventEmitter","ViewportTrackingHelper","SubscriptionsHandler","debounce","throttle","Vector","getElementPosition"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(o,p,q){"use strict";this.getAllStoriesInfo=p;this.conservative_initial_logging=!!o.conservative_initial_logging;this.readStoryIDs={};this.minSizeToBeVisible=200;this.porportionRatio=.5;this.is_proportion=!!o.is_proportion;if(this.is_proportion)this.proportionRatio=o.proportion_ratio;if(!o.scroll_only&&!o.conservative_initial_logging){this.fireTimer();}else if(o.conservative_initial_logging){this.initialStories=this.getUnreadStoriesInfoInView();this.initialStoriesLogged=false;}this.subscriptions=new i();var r=j(this.fireTimer,q,this);this.subscriptions.addSubscriptions(h.getScrollListener(r));this.isLoose=!!o.is_loose;this.maxScrollPosition=0;if(this.isLoose){this.minSizeToBeVisible=0;var s=k(function(){this.maxScrollPosition=Math.max(this.maxScrollPosition,l.getScrollPosition().y);}.bind(this));this.subscriptions.addSubscriptions(h.getScrollListener(s));}}n.prototype.cleanup=function(){"use strict";if(this.subscriptions){this.subscriptions.release();this.subscriptions=null;}this.readStoryIDs=null;this.initialStories=null;};n.prototype.fireTimer=function(){"use strict";if(this.conservative_initial_logging&&!this.initialStoriesLogged){this.initialStories.forEach(this.markStoryRead,this);this.initialStoriesLogged=true;}this.getUnreadStoriesInfoInView().forEach(this.markStoryRead,this);this.emit('viewport_steady');};n.prototype.markStoryRead=function(o){"use strict";var p=o.story_id;if(!p||this.hasBeenVisible(p))return;this.readStoryIDs[p]=true;this.emit('story_read',o);};n.prototype.getUnreadStoriesInfoInView=function(){"use strict";var o=this.getAllStoriesInfo(),p=[],q=false;for(var r=0;r<o.length;r++){var s=o[r].story,t=o[r].story_id;if(this.hasBeenVisible(t))continue;var u=m(s),v=false;if(this.isLoose){v=h.looseIsVisible(u,this.maxScrollPosition);}else{var w=this.minSizeToBeVisible;if(this.is_proportion)w=u.height*this.proportionRatio;v=h.isVisible(u,w);}if(v){p.push(o[r]);q=true;}else if(q)break;}return p;};n.prototype.hasBeenVisible=function(o){"use strict";return o in this.readStoryIDs;};g(n,{story_read:true,viewport_steady:true});e.exports=n;},null);
__d("ViewportTrackingRefactored",["ViewportStoryReadabilityEmitter","ViewportDurationEmitter","Arbiter","AsyncSignal","Banzai","BanzaiScuba","CSS","cx","CurrentUser","DOMDimensions","NavigationMessage","Run","Style","SubscriptionsHandler","Event","clickRefAction","collectDataAttributes","copyProperties","getElementPosition","ErrorUtils","CacheStorage","WebStorage","bolt/util"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){var da=97,ea=51,fa='vpv',ga='incremental_count',ha='incremental_key';function ia(){"use strict";}ia.prototype.init=function(ja){"use strict";this.useBanzai=!!ja.banzai;this.banzaiNoDelay=!!ja.banzai_no_delay;this.banzaiRetry=!!ja.banzai_retry;this.useLocalStorage=!!ja.use_local_storage;this.useIncrementalCount=!!ja.use_incremental_count;this.useAsync=!!ja.async;this.useStoriesCaching=false;this.cachedStoriesInfo=null;this.cachedViewportHeight=p.getViewportDimensions().height;this.isTimetrackingEnabled=0;this.storiesToBeMarkedSeen=[];this._headLoadStoryCount=0;this.getDataFromConfig(ja);var ka=z.guard(this.getAllStoriesInfo,'ViewportTrackingRefactored:getAllStoriesInfoCallback',this);this.readabilityTracker=new g(ja,ka,this.getTimeout());this.readabilityTracker.addListener('story_read',this.handleStoryRead.bind(this));this.readabilityTracker.addListener('viewport_steady',this.handleViewportSteady.bind(this));if(this.isTimetrackingEnabled){this.durationTracker=new h(ja.tracking_duration_config,ka);this.durationTracker.addListener('story_was_in_view',this.handleStoryWasInView.bind(this));}this.vpvHeartBeatInterval=ja.vpv_heartbeat_interval;this.passVPVHeartbeatGK=ja.use_vpv_heartbeat;if(this.passVPVHeartbeatGK){this.intervalCount=1;this.fireTimerCount=1;this.vpvHeartBeatIntervalSignal=setInterval(function(){this._sendSignal('interval');}.bind(this),this.vpvHeartBeatInterval);}this.subscriptions=new t();this.subscriptions.addSubscriptions(u.listen(window,'resize',function(){this.cachedViewportHeight=p.getViewportDimensions().height;}.bind(this)),i.subscribe(q.NAVIGATION_BEGIN,this.cleanup.bind(this)),i.subscribe('Stream/totalHeadLoadedStories',function(la,ma){this._headLoadStoryCount=ma;}.bind(this)));r.onLeave(this.cleanup.bind(this));};ia.prototype.cleanup=function(){"use strict";if(this.subscriptions){this.subscriptions.release();this.subscriptions=null;}this.readabilityTracker.cleanup();if(this.durationTracker)this.durationTracker.cleanup();if(this.passVPVHeartbeatGK)clearInterval(this.vpvHeartBeatIntervalSignal);this._headLoadStoryCount=0;};ia.prototype.heartBeatIsEnabled=function(){"use strict";return false;};ia.prototype.getAllStoriesInfo=function(){"use strict";if(this.cachedStoriesInfo)return this.cachedStoriesInfo;var ja=[],ka=this.getAllStories();for(var la=0;la<ka.length;la++){var ma=ka[la],na=this.getStoryID(ka[la]);if(ma.getAttribute('data-insertion-position')===null)ma.setAttribute('data-insertion-position',la-this._headLoadStoryCount);ja.push({story:ma,story_id:na});}if(this.useStoriesCaching)this.cachedStoriesInfo=ja;return ja;};ia.prototype.invalidateAllStoriesCache=function(){"use strict";this.cachedStoriesInfo=null;};ia.prototype.handleStoryRead=function(ja){"use strict";var ka=ja.story,la=ja.story_id,ma=this.getDataToLog(ka),na=w(ka,['ft']);x(ma.ft,na.ft);delete ma.ei;this.markStoryReadInLocalStorage(la);this.sendDataToLog(ka,ma,this.banzaiNoDelay,this.banzaiRetry);m.addClass(ka,"_x72");this.storiesToBeMarkedSeen.push(ka);this.signalStory=ka;};ia.prototype.handleViewportSteady=function(){"use strict";this.addSeenClass();if(this.passVPVHeartbeatGK)this._sendSignal('fireTimer');};ia.prototype.handleStoryWasInView=function(ja,ka,la){"use strict";if(this.isTimetrackingEnabled){var ma=this.getTimetrackingDataToLog(ja,ka,la),na=w(ja,['ft']);x(ma.ft,na.ft);var oa=!!na.ft.ei&&(ma.ft.vpvd_time_delta>this.minTimeToReportImmediately);delete ma.ei;this.sendDataToLog(ja,ma,oa,false);if(this.useLocalStorage&&ma.ft.vpvd_time_delta>this.localStorageLogMinDurationMs){var pa=this.getStoryID(ja);this.markStoryReadInLocalStorage(pa);}}};ia.prototype.getIncrementalVpvCnt=function(){"use strict";var ja=ba.getLocalStorage(),ka=0;if(!ja)return 0;var la='vpv_local_log.'+ga,ma='vpv_local_log.'+ha;if(ja.getItem(la))ka=parseInt(ja.getItem(la),10);if(ka===0)ja.setItem(ma,ca.generateUUID());ja.setItem(la,ka+1);return ka;};ia.prototype.getTimetrackingDataToLog=function(ja,ka,la){"use strict";var ma={evt:da,vpvd_start_timestamp:ka,vpvd_time_delta:la-ka,story_height:p.getElementDimensions(ja).height,viewport_height:this.cachedViewportHeight};return {ft:ma};};ia.prototype.markStoryReadInLocalStorage=function(ja){"use strict";if(this.useLocalStorage){var ka='vpv_local_log.'+parseInt(Date.now()/1000/3600,10)+'h',la=new aa('localstorage',ka);la.set(ja,1);}};ia.prototype.getIncrementalVpvKey=function(){"use strict";var ja=ba.getLocalStorage(),ka='vpv_local_log.'+ha;if(!ja||!ja.getItem(ka))return '';return ja.getItem(ka);};ia.prototype.sendDataToLog=function(ja,ka,la,ma){"use strict";if(this.useBanzai){var na={};if(la)na.delay=3000;if(ma)na.retry=true;if(this.useIncrementalCount&&ka.ft&&ka.ft.evt==ea){ka.ft.incrementalVpvCnt=this.getIncrementalVpvCnt();ka.ft.incrementalVpvKey=this.getIncrementalVpvKey();}k.post('feed_tracking',ka,na);if(this.useAsync&&ka.ft.evt==ea)new j('/ajax/feed/feed_tracking/temp_vpv_logging',ka.ft).send();}else v(fa,ja,null,'FORCE',ka);};ia.prototype.addSeenClass=function(){"use strict";for(var ja=this.storiesToBeMarkedSeen.length-1;ja>=0;ja--){var ka=this.storiesToBeMarkedSeen[ja],la=this.getStoryID(ka),ma=y(ka);if(la&&ma.y<0&&(m.hasClass(ka,"_50mx")||m.hasClass(ka,"_2z-5"))){m.addClass(ka,"_50nb");m.removeClass(ka,"_50mx");m.removeClass(ka,"_2z-5");this.storiesToBeMarkedSeen.splice(ja,1);}}};ia.prototype._sendSignal=function(ja){"use strict";if(!this.heartBeatIsEnabled())return;var ka=-1;if(ja=='interval'){ka=this.intervalCount++;}else if(ja=='fireTimer')ka=this.fireTimerCount++;var la=-1,ma=-1,na=-1;if(this.signalStory){la=this.getStoryID(this.signalStory);ma=this.getQueryID(this.signalStory);na=this.getFBFeedLocation(this.signalStory);}var oa=new l('vpv_heartbeat_js');oa.addInteger('qid',ma);oa.addInteger('uid',o.getID());oa.addInteger('firststoryid',la);oa.addInteger('time',Math.round(Date.now()/1000));oa.addNormal('type',ja);oa.addInteger('count',ka);oa.addInteger('fbfeed_location',na);oa.post();};ia.prototype.getQueryID=function(ja){"use strict";return -1;};ia.prototype.getFBFeedLocation=function(ja){"use strict";return -1;};e.exports=ia;},null);
__d("collectSubtreeData",[],function(a,b,c,d,e,f){function g(i,j,k,l,m){if(i.offsetWidth===0&&i.offsetHeight===0)return m;var n={};if(i.getAttribute)for(r=0;r<j.length;r++){t=j[r];var o=i.getAttribute(k[t]);if(o){n[t]={};var p=JSON.parse(o);for(var q in l)if(p[q]!==undefined){n[t][q]=true;if(m[t]===undefined)m[t]={};if(m[t][q]===undefined)m[t][q]=[];if(l[q].length>0)m[t][q].push(l[q]);m[t][q].push('('+p[q]);}}}for(var r=0;r<i.childNodes.length;r++){var s=i.childNodes[r];g(s,j,k,l,m);}for(var t in n)for(var u in n[t]){var v=m[t][u][m[t][u].length-1];if(v.length>0&&v.charAt(0)=='('){m[t][u][m[t][u].length-1]=v.substr(1);}else m[t][u].push(')');}return m;}function h(i,j){var k={};for(var l=0;l<j.length;++l)k[j[l]]='data-'+j[l];var m={tn:"","tn-debug":","},n={};g(i,j,k,m,n);for(var o in n)for(var p in n[o])n[o][p]=n[o][p].join('');return n;}e.exports=h;},null);
__d("recordTNTreeData",["collectSubtreeData"],function(a,b,c,d,e,f,g){function h(i,j){var k={},l=g(i,['ft']);for(var m in l.ft){k[m+'_tree']=l.ft[m];if(m==='tn-debug')i.setAttribute('tn-debug_subtree',l.ft[m]);}k.evt_value=i.offsetHeight;if(j)k.offset=Math.max(0,i.offsetTop-j.offsetTop);return k;}e.exports=h;},null);
__d("StoryTopicMap",[],function(a,b,c,d,e,f){var g={},h={registerTopics:function(i,j){g[i]=j;},getTopicsForFTID:function(i){return g[i]||[];}};e.exports=h;},null);
__d("XFeedAdsChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/feed\/ads_chaining\/",{actor_id:{type:"String",required:true},ft_id:{type:"String"},origin:{type:"String",required:true},ei:{type:"String",required:true},data_ownerid:{type:"String",required:true}});},null);
__d("XPubcontentFeedChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/pubcontent\/feed_chaining\/",{actor_id:{type:"String",required:true},content_id:{type:"String"},ft_id:{type:"String"},origin:{type:"String",required:true}});},null);
__d("XPubcontentRelatedShareChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/pubcontent\/related_share\/",{attachment_div_id:{type:"String",required:true},global_share_id:{type:"Int",required:true},video_div_id:{type:"String"},link_url:{type:"String"},qid:{type:"String"},mf_story_key:{type:"String"},share_id:{type:"String"},is_auto_expand:{type:"Bool"}});},null);
__d("XPubcontentRelatedVideoChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/pubcontent\/related_video\/",{attachment_div_id:{type:"String",required:true},fbvideo_id:{type:"Int"},qid:{type:"String"},mf_story_key:{type:"String"}});},null);
__d("XPubcontentTopicChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/pubcontent\/topic_chaining\/",{pivotal_topic_ids:{type:"IntVector"}});},null);
__d("XPubcontentInlineStoryPivotChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/pubcontent\/inline_story_pivot_chaining\/",{origin:{type:"String",required:true},storyid:{type:"String"},ftid:{type:"String"}});},null);
__d("XRelatedGamesChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/games\/async\/related_games\/",{attachment_div_id:{type:"String",required:true},app_id:{type:"Int",required:true}});},null);
__d("PubcontentFeedChainingController",["AggregatedLinkComposerConfig","Arbiter","AsyncRequest","AttachmentRelatedShareConstants","CSS","cx","DOM","DOMQuery","FeedAdsChainingConfig","PageAdsAttachmentLinkShareConstants","PageLikeButton","PubcontentFeedChainingConfig","PubcontentRelatedShareChainingConfig","PubcontentTopicChainingConfig","StoryInlinePivotChainingConfig","StoryTopicMap","UFIFeedbackTargets","UFIUIEvents","XFeedAdsChainingControllerURIBuilder","XPubcontentFeedChainingControllerURIBuilder","XPubcontentRelatedShareChainingControllerURIBuilder","XPubcontentRelatedVideoChainingControllerURIBuilder","XPubcontentTopicChainingControllerURIBuilder","XPubcontentInlineStoryPivotChainingControllerURIBuilder","XRelatedGamesChainingControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){var fa='ei',ga='ad_fan_page_action',ha='ad_like_page_post_action',ia='ad_share_attachment_click_action',ja='page_story_like_action',ka='related_share_article_click',la='related_share_video_click',ma='page_share_like_action',na='topic_story_like_action',oa='story_click_for_pivot_action',pa='story_like_pivot_action';function qa(){"use strict";this.$PubcontentFeedChainingController0=r;this.$PubcontentFeedChainingController1=o;this.$PubcontentFeedChainingController2=s;this.$PubcontentFeedChainingController3=t;this.$PubcontentFeedChainingController4=u;this.$PubcontentFeedChainingController5={};h.subscribe(q.LIKED,this.$PubcontentFeedChainingController6.bind(this));h.subscribe(x.UFIActionLinkLike,this.$PubcontentFeedChainingController7.bind(this));h.subscribe(j.ARTICLE_CLICK,this.$PubcontentFeedChainingController8.bind(this));h.subscribe(j.VIDEO_CLICK,this.$PubcontentFeedChainingController9.bind(this));h.subscribe(j.FBVIDEO_CLICK,this.$PubcontentFeedChainingControllera.bind(this));h.subscribe(j.GAME_CLICK,this.$PubcontentFeedChainingControllerb.bind(this));h.subscribe(p.LINK_ATTACHMENT_CLICK,this.$PubcontentFeedChainingControllerc.bind(this));h.subscribe(j.PHOTO_CLICK,this.$PubcontentFeedChainingControllerd.bind(this));qa.instance=this;}qa.getAdClientTokenIndex=function(){"use strict";return fa;};qa.prototype.$PubcontentFeedChainingController6=function(ra,sa){"use strict";var ta=this.findAdClientToken(sa.target);if(ta){this.$PubcontentFeedChainingControllere(sa.target,{origin:ga,actor_id:sa.profile_id,client_token:ta});}else this.$PubcontentFeedChainingControllerf(sa.target,{origin:sa.origin,actor_id:sa.profile_id});};qa.prototype.$PubcontentFeedChainingController7=function(ra,sa){"use strict";if(!sa.ft_id)return;if(!this.$PubcontentFeedChainingControllerg(this.findStory(sa.target)))return;w.getFeedbackTarget(sa.ft_id,function(ta,ua){var va=this.findAdClientToken(ta);if(va&&ua.isshare){this.$PubcontentFeedChainingControllere(ta,{actor_id:ua.actorid,origin:ha,ft_id:ua.entidentifier,client_token:va});}else if(ua.isownerpage){this.$PubcontentFeedChainingControllerf(ta,{actor_id:ua.actorid,content_id:ua.entidentifier,origin:ja});}else if(ua.isshare){this.$PubcontentFeedChainingControllerf(ta,{actor_id:ua.actorid,ft_id:ua.entidentifier,origin:ma});}else{var wa=v.getTopicsForFTID(ua.entidentifier);if(wa&&wa.length>0){this.$PubcontentFeedChainingControllerh(ta,{ft_id:ua.entidentifier,origin:na,pivotal_topic_ids:wa});}else this.$PubcontentFeedChainingControlleri(ta,{origin:pa,ft_id:ua.entidentifier});}}.bind(this,sa.target));};qa.prototype.$PubcontentFeedChainingControlleri=function(ra,sa){"use strict";var ta=this.$PubcontentFeedChainingControllerj(ra,sa);if(!ta)return false;var ua=(new da()).setString('origin',sa.origin);if(sa.story_id)ua.setString('storyid',String(sa.story_id));if(sa.ft_id)ua.setString('ftid',String(sa.ft_id));new i().setErrorHandler(this.$PubcontentFeedChainingControllerk.bind(this,ta.story.id)).setRelativeTo(ta.chainingWrapper).setURI(ua.getURI()).setAllowCrossPageTransition(true).send();return true;};qa.prototype.$PubcontentFeedChainingControllerd=function(ra,sa){"use strict";var ta=this;ta.$PubcontentFeedChainingControlleri(sa.attachment,{origin:oa,story_id:sa.storyid});};qa.prototype.$PubcontentFeedChainingController8=function(ra,sa){"use strict";if(g.no_chained_related_stories==='true')return;sa.origin=ka;var ta=this,ua=this.findStory(sa.attachment),va=n.scry(n.getRootElement(),'#initial_browse_result').length>0;if(va)return;var wa;if(sa.is_right_click){wa=0;}else wa=j.EVENT_DELAY;setTimeout(function(){if(ua){var xa=ta.findAttachment(ua);if(xa)sa.attachment=xa;}ta.$PubcontentFeedChainingControllerl(sa.attachment,sa);},wa);};qa.prototype.$PubcontentFeedChainingController9=function(ra,sa){"use strict";sa.origin=la;var ta=this,ua=this.findStory(sa.attachment);setTimeout(function(){if(ua){var va=ta.findAttachment(ua);if(va)sa.attachment=va;}ta.$PubcontentFeedChainingControllerl(sa.attachment,sa);},j.EVENT_DELAY);};qa.prototype.$PubcontentFeedChainingControllera=function(ra,sa){"use strict";sa.origin=la;var ta=this,ua=this.findStory(sa.attachment);setTimeout(function(){if(ua){var va=ta.findAttachment(ua);if(va)sa.attachment=va;}ta.$PubcontentFeedChainingControllerl(sa.attachment,sa);},j.EVENT_DELAY);};qa.prototype.$PubcontentFeedChainingControllerb=function(ra,sa){"use strict";var ta=this,ua=this.findStory(sa.attachment);setTimeout(function(){if(ua)var va=ta.findContainer(ua);ta.$PubcontentFeedChainingControllerm(ua,sa.global_share_id,m.getID(va));},j.EVENT_DELAY);};qa.prototype.$PubcontentFeedChainingControllerc=function(ra,sa){"use strict";var ta=this.findAdClientToken(sa.attachment);if(ta){sa.origin=ia;sa.client_token=ta;this.$PubcontentFeedChainingControllere(sa.attachment,sa);}};qa.prototype.$PubcontentFeedChainingControllern=function(ra){"use strict";return !!(ra&&ra.id&&!k.hasClass(ra,"_sf6")&&!(ra.id in this.$PubcontentFeedChainingController5));};qa.prototype.$PubcontentFeedChainingControllero=function(ra){"use strict";if(!ra)return false;if(ra.origin in this.$PubcontentFeedChainingController0||ra.origin in this.$PubcontentFeedChainingController2||ra.origin in this.$PubcontentFeedChainingController1||ra.origin in this.$PubcontentFeedChainingController4){return true;}else{var sa=this.$PubcontentFeedChainingController3[ra.origin];if(!sa||!sa.rate)return false;var ta=Math.random();if(ta>sa.rate)return false;return true;}};qa.prototype.$PubcontentFeedChainingControllerp=function(ra){"use strict";this.$PubcontentFeedChainingController5[ra]=true;};qa.prototype.$PubcontentFeedChainingControllerk=function(ra){"use strict";delete this.$PubcontentFeedChainingController5[ra];};qa.prototype.$PubcontentFeedChainingControllerg=function(ra){"use strict";if(!ra)return false;var sa="_2bex",ta=ra.nextSibling;if(ta&&ta.firstChild){var ua=ta.firstChild;return !(ua.hasChildNodes()&&k.hasClass(ua,sa));}return true;};qa.prototype.$PubcontentFeedChainingControllerj=function(ra,sa){"use strict";var ta=this.findStory(ra);if(!this.$PubcontentFeedChainingControllern(ta))return null;if(!this.$PubcontentFeedChainingControllero(sa))return null;this.$PubcontentFeedChainingControllerp(ta.id);if(this.isSponsoredStory(ta))return null;var ua;if(!sa.continued_chaining){ua=this.findContainer(ta);if(!ua)return null;var va=m.create('div'),wa=m.appendContent(ua,va);if(wa.length!==1)return null;}else{ua=ta;va=m.create('div');wa=m.insertAfter(ua,va);m.remove(ua);if(wa.length!==1)return null;}if(sa.is_auto_expand){return {chainingWrapper:wa[0],story:ta,is_auto_expand:sa.is_auto_expand};}else return {chainingWrapper:wa[0],story:ta};};qa.prototype.$PubcontentFeedChainingControllere=function(ra,sa){"use strict";var ta=this.$PubcontentFeedChainingControllerj(ra,sa);if(!ta)return false;var ua=this.findStreamRoot(ta.story);if(!ua)return false;var va=ua.getAttribute('id'),wa=(new y()).setString('actor_id',sa.actor_id).setString('origin',sa.origin).setString('ei',sa.client_token).setString('data_ownerid',va);if(sa.ft_id)wa.setString('ft_id',sa.ft_id);new i().setErrorHandler(this.$PubcontentFeedChainingControllerk.bind(this,ta.story.id)).setRelativeTo(ta.chainingWrapper).setURI(wa.getURI()).send();return true;};qa.prototype.$PubcontentFeedChainingControllerl=function(ra,sa){"use strict";if(!this.$PubcontentFeedChainingControllerg(this.findStory(ra)))return false;var ta=this.$PubcontentFeedChainingControllerj(ra,sa);if(!ta)return false;k.addClass(ta.chainingWrapper,"_2bex");var ua=null;if(sa.fbvideo_id){ua=new ba();ua.setInt('fbvideo_id',sa.fbvideo_id);}else{ua=new aa();ua.setInt('global_share_id',sa.global_share_id);}ua.setString('attachment_div_id',m.getID(sa.attachment));if(sa.link_url)ua.setString('link_url',sa.link_url);if(sa.video_div_id)ua.setString('video_div_id',sa.video_div_id);if(sa.share_id)ua.setString('share_id',sa.share_id);var va=JSON.parse(ta.story.getAttribute('data-ft'))||{};if('qid' in va&&'mf_story_key' in va){ua.setString('qid',va.qid);ua.setString('mf_story_key',va.mf_story_key);}if(sa.is_auto_expand){this.$PubcontentFeedChainingControllerk(ta.story.id);ua.setBool('is_auto_expand',sa.is_auto_expand);}var wa=new i().setErrorHandler(this.$PubcontentFeedChainingControllerk.bind(this,ta.story.id)).setRelativeTo(ta.chainingWrapper).setURI(ua.getURI());va&&wa.setData(va);wa.send();return true;};qa.prototype.$PubcontentFeedChainingControllerm=function(ra,sa,ta){"use strict";if(!this.$PubcontentFeedChainingControllern(ra))return;this.$PubcontentFeedChainingControllerp(ra.id);var ua=(new ea()).setInt('app_id',sa).setString('attachment_div_id',ta);new i().setErrorHandler(this.$PubcontentFeedChainingControllerk.bind(this,ra.id)).setURI(ua.getURI()).send();return true;};qa.prototype.$PubcontentFeedChainingControllerf=function(ra,sa){"use strict";var ta=this.$PubcontentFeedChainingControllerj(ra,sa);if(!ta)return false;var ua=(new z()).setString('actor_id',sa.actor_id).setString('origin',sa.origin);if(sa.ft_id)ua.setString('ft_id',sa.ft_id);if(sa.content_id)ua.setString('content_id',sa.content_id);new i().setErrorHandler(this.$PubcontentFeedChainingControllerk.bind(this,ta.story.id)).setRelativeTo(ta.chainingWrapper).setURI(ua.getURI()).send();return true;};qa.prototype.$PubcontentFeedChainingControllerh=function(ra,sa){"use strict";var ta=this.$PubcontentFeedChainingControllerj(ra,sa);if(!ta)return false;var ua=(new ca()).setIntVector('pivotal_topic_ids',sa.pivotal_topic_ids).getURI();new i().setErrorHandler(this.$PubcontentFeedChainingControllerk.bind(this,ta.story.id)).setRelativeTo(ta.chainingWrapper).setURI(ua).send();return true;};e.exports=qa;},null);
__d("PubcontentLitestandClassicChainingController",["ContextualThing","DOM","PubcontentFeedChainingController","csx"],function(a,b,c,d,e,f,g,h,i,j){for(var k in i)if(i.hasOwnProperty(k))m[k]=i[k];var l=i===null?null:i.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=i;function m(){"use strict";if(i!==null)i.apply(this,arguments);}m.prototype.findStory=function(n){"use strict";var o="^div._4-u2",p=h.scry(n,o);return p.length===1?p[0]:null;};m.prototype.isSponsoredStory=function(n){"use strict";var o="._5paw";return h.scry(n,o).length>0;};m.prototype.findAttachment=function(n){"use strict";var o="div._6m2",p="div.iframeEmbed",q=h.scry(n,o)[0]||h.scry(n,p)[0];return q;};m.prototype.findContainer=function(n){"use strict";var o=h.create('div'),p=h.insertAfter(n,o);g.register(o,n);return p.length>=1?p[0]:null;};m.prototype.findStreamRoot=function(n){"use strict";var o="^div._4ikz";return h.scry(n,o)[0];};m.prototype.findAdClientToken=function(n){"use strict";var o=this.findStory(n);if(!o)return null;var p=o.getAttribute('data-ft');if(!p)return null;var q=JSON.parse(p);return q[i.getAdClientTokenIndex()];};e.exports=m;new m();},null);
__d("StoryPositionTracking",["DOM","LitestandStream","csx","ge"],function(a,b,c,d,e,f,g,h,i,j){var k=0;function l(o,p){var q=JSON.parse(o.getAttribute('data-ft'));q.insertion_position=p;o.setAttribute('data-ft',JSON.stringify(q));}function m(o){return g.scry(o,"._5jmm");}var n={registerNewStories:function(o){if(o=='substream_0')k=0;var p=m(j(o)),q=p.length;for(var r=0;r<q;r++)l(p[r],k++);},updateAllStories:function(){var o=m(h.getStreamRoot()),p=o.length;k=0;for(var q=0;q<p;q++)l(o[q],k++);}};e.exports=n;},null);
__d("StreamViewportTracking",["DOM","DOMDimensions","ViewportTrackingRefactorGK","ge","recordTNTreeData","ViewportTrackingRefactored","ViewportTracking"],function(a,b,c,d,e,f,g,h,i,j,k){var l;if(i.use_refactored_code){l=b('ViewportTrackingRefactored');}else l=b('ViewportTracking');var m=51;for(var n in l)if(l.hasOwnProperty(n))p[n]=l[n];var o=l===null?null:l.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=l;function p(){"use strict";if(l!==null)l.apply(this,arguments);}p.prototype.init=function(q,r){"use strict";if(r)this.$StreamViewportTracking0=r;o.init.call(this,q);this.initSubscriptions();};p.prototype.initSubscriptions=function(){"use strict";};p.prototype.getDataFromConfig=function(q){"use strict";this.recordTNTree=q.record_tn_tree;this.timeout=q.record_delay;this.isTimetrackingEnabled=!!q.is_timetracking_enabled;this.useStoriesCaching=true;};p.prototype.getTimeout=function(){"use strict";return this.timeout;};p.prototype.getStorySelector=function(){"use strict";return '.uiStreamStory';};p.prototype.getAllStories=function(){"use strict";var q=g.scry(this.getStream(),this.getStorySelector());return q.filter(function(r){return r.getAttribute('data-ft');});};p.prototype.getStoryID=function(q){"use strict";var r=JSON.parse(q.getAttribute('data-ft'));return r.mf_story_key;};p.prototype.getQueryID=function(q){"use strict";var r=JSON.parse(q.getAttribute('data-ft'));return r.qid;};p.prototype.getFBFeedLocations=function(q){"use strict";var r=JSON.parse(q.getAttribute('data-ft'));return r.fbfeed_location;};p.prototype.getDataToLog=function(q){"use strict";var r={};if(this.recordTNTree){var s=this.getStream();r=k(q,s);var t=q.getAttribute('data-insertion-position');if(t!==null)r.inspos=t;}r.evt=m;r.vpv_time=Math.round(Date.now()/1000);var u=g.scry(q,".fbStoryAttachmentImage")[0];if(u){var v=h.getElementDimensions(u);r.story_image_height=v.height;r.story_image_width=v.width;}return {ft:r};};p.prototype.getStream=function(){"use strict";if(this.$StreamViewportTracking0)return this.$StreamViewportTracking0;return j('home_stream');};p.prototype.heartBeatIsEnabled=function(){"use strict";return true;};p.init=function(q,r){"use strict";p.instance=new p();p.instance.init(q,r);};p.getInstance=function(){"use strict";return p.instance;};e.exports=p;},null);
__d("FbFeedAttachmentRelatedShare",["Arbiter","AttachmentRelatedShareConstants","DOM","Event","tidyEvent","csx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={loadRelatedAttachment:function(n,o){k(j.listen(n,'click',function(){g.inform(h.ARTICLE_CLICK,{attachment:n,global_share_id:o});}));},loadRelatedVideoAttachment:function(n,o){k(j.listen(n,'click',function(){g.inform(h.VIDEO_CLICK,{attachment:n,global_share_id:o});}));},loadRelatedGameAttachment:function(n,o){k(j.listen(n,'click',function(){g.inform(h.GAME_CLICK,{attachment:n,global_share_id:o});}));},loadRelatedAttachmentForStream:function(n){var o=function(event,p){var q=event.getTarget();if(q.getAttribute('target')!=='_blank')return;var r="^div._5pbx",s="^div._5pc9",t=i.scry(q,r)[0]||i.scry(q,s)[0];if(!t)return;g.inform(h.ARTICLE_CLICK,{attachment:t,global_share_id:0,link_url:q.getAttribute('href'),is_right_click:p});};k(j.listen(n,'click',function(event){o(event,false);}));k(j.listen(n,'mousedown',function(event){if(event.which==3||event.button==2)o(event,true);}));},closeButton:function(n,o){k(j.listen(n,'click',function(){i.remove(o);}));}};e.exports=m;},null);
__d("FbFeedViewportTracking",["ViewportTrackingRefactorGK","Arbiter","LitestandMessages","LitestandStream","StreamViewportTracking","csx"],function(a,b,c,d,e,f,g,h,i,j,k,l){for(var m in k)if(k.hasOwnProperty(m))o[m]=k[m];var n=k===null?null:k.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=k;function o(){"use strict";if(k!==null)k.apply(this,arguments);}o.prototype.initSubscriptions=function(){"use strict";this.subscriptions.addSubscriptions(h.subscribe([i.STORIES_INSERTED],this.invalidateAllStoriesCache.bind(this)),h.subscribe(i.LEAVE_HOME,g.use_refactored_code?this.durationTracker.updateTimeTrackingData.bind(this,true):this.updateTimeTrackingData.bind(this,true)));};o.prototype.getStorySelector=function(){"use strict";return "._5jmm";};o.prototype.getStream=function(){"use strict";return j.getStreamRoot();};o.prototype.getSessionID=function(){"use strict";return j.getFeedStreamID();};o.init=function(p){"use strict";new o().init(p);};e.exports=o;},null);